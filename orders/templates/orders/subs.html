<!DOCTYPE html>
<html>
    <head>
        <title>Pinocchio's Pizza & Subs</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script tpye="text/javascript">
        document.addEventListener('DOMContentLoaded', () => {

            document.querySelector('#num_order').innerHTML =  {{ num_order}};


            document.querySelector('#cart').onclick= () => {
              const request = new XMLHttpRequest();
              request.open('POST', '/order');
              // Callback function for when request completes
              request.onload = () => {
                  const data = JSON.parse(request.responseText);
                  document.querySelector('#num_order').innerHTML = data.num_order;
              }
              var num_order = document.querySelector('#num_order').innerHTML;
              num_order++;
              const data = new FormData();
              data.append('num_order', num_order);
              function getCookie(name) {
                  var cookieValue = null;
                  if (document.cookie && document.cookie !== '') {
                      var cookies = document.cookie.split(';');
                      for (var i = 0; i < cookies.length; i++) {
                          var cookie = cookies[i].trim();
                          // Does this cookie string begin with the name we want?
                          if (cookie.substring(0, name.length + 1) === (name + '=')) {
                              cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                              break;
                          }
                        }
                  }
                  return cookieValue;
              }
              request.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
              request.send(data);
              return false;
            }
        });

        </script>

    </head>
    <body>
    <br>

    <center>
        <h1 class="display-4 font-weight-bold">Pinocchio's Pizza & Subs</h1>
    </center>
    <br>

    <div class="container">


        <h4 style="float:left"> Welcome, {{ user.username }}! </h4>
        <a href="{% url 'logout' %}" class="btn btn-light" style="float:left;margin-left:20px">logout</a>
        <a href="{% url 'cart' %}" class="btn btn-outline-primary" style="float:right">shopping cart <span class="badge badge-primary" id="num_order"></span></a>
        <br>
        <br>

        <ul  class="nav justify-content-center nav-pills">
            <li class="nav-item"><a class="nav-link " href="{% url 'pizza' %}">pizza</a></li>
            <li class="nav-item"><a class="nav-link active" href="{% url 'subs' %}">subs</a></li>
            <li class="nav-item"><a class="nav-link " href="{% url 'pasta' %}">pasta</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'salads' %}">salads</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'dinner' %}">dinner platters</a></li>
        </ul>
        <br>

        {% if message %}
            <div class="alert alert-danger" role="alert">
            {{ message }}
            </div>
        {% endif %}
        <h3>type</h3>
       <form action="{% url 'subs' %}" method="post">
        {% csrf_token %}
        <div class="row">
        {% for s in subs %}
        {% if forloop.counter0|divisibleby:3 %}
      </div>
      <br>
      <div class="row">
        <div class="col-sm-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">{{s.kind}}</h5>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="{{s.kind}}" name="sub[]">
                <label class="form-check-label" for="defaultCheck1">want it</label>
              </div>
            </div>
          </div>
        </div>
          {% else %}
          <div class="col-sm-4">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">{{s.kind}}</h5>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="{{s.kind}}" name="sub[]">
                  <label class="form-check-label" for="defaultCheck1">want it</label>
                </div>
              </div>
            </div>
          </div>
          {% endif %}
          {% endfor %}
        </div>
          <br>
          <br>
          <h3>size</h3>
              <div class="row">
                  <div class="col-sm-6">
                      <div class="card">
                          <div class="card-body">
                              <h5 class="card-title">small</h5>
                            <div class="form-check">
                              <input class="form-check-input" type="checkbox" value="small" name="size[]">
                              <label class="form-check-label" for="defaultCheck1">want it</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">large</h5>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="large" name="size[]">
                                <label class="form-check-label" for="defaultCheck1">want it</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <br>



                Do you want extra cheese of $ 0.5?
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" name="extra[]" value="yes">
                  <label class="form-check-label" for="inlineCheckbox1">yes</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" name="extra[]" value="no">
                  <label class="form-check-label" for="inlineCheckbox2">no</label>
                </div>
                <br>
                <br>


          <div class="card"">
              <div class="card-body">
                  <h5 class="card-title">add-ons for the steak</h5>
                  <h6 class="card-subtitle mb-2 text-muted">
                  When you have chosen <span class="font-weight-bold">steak</span> in <span class="font-weight-bold">type</span> section, you can choose one add-on.
                  </h6>
                  <p class="card-text">
                  <div class="row">
                  {% for steak in steaks %}
                  {% if forloop.counter0|divisibleby:4 %}
                  </div>
                  <div class="row">
                      <div class="col-sm-3">
                          <div class="form-check">
                              <input class="form-check-input" type="checkbox" value="{{steak.addonkind}}"  name="addon[]">
                              <label class="form-check-label" for="defaultCheck1">{{steak.addonkind}}</label>
                          </div>
                      </div>
                      {% else %}
                      <div class="col-sm-3">
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="{{steak.addonkind}}"  name="addon[]">
                            <label class="form-check-label" for="defaultCheck1">{{steak.addonkind}}</label>
                          </div>
                      </div>
                  {% endif %}
                  {% endfor %}
                  </div>
                  </p>
              </div>
          </div>
          <br>
          <button style="float:left" type="submit" class="btn btn-info">check the price</button>
    </form>
    <button style="float:right;" id="cart" class="btn btn-success">add to the shopping cart</button>
    {% if price %}
         <span style="font-size: 20px; float:right; margin-right:20px" id="check_price">{{ price }}</span>  <h3 style="float:right; margin-right:20px">price:</h3>
    {% endif %}

      </div>
    </body>
</html>
